<div class="game-room">
  <header>
    <h2>Local PvP</h2>
  </header>

  <!-- Game Settings and Player Names -->
  <section class="settings" *ngIf="!gameInProgress && !currentGame">
    <div class="setting-item">
      <h4>Max Rounds</h4>
      <input
        type="number"
        [(ngModel)]="settings.maxRounds"
        min="1"
        class="form-control"
        placeholder="Enter max rounds"
      />
    </div>
    <div class="setting-item">
      <h4>Round Score Limit</h4>
      <input
        type="number"
        [(ngModel)]="settings.roundScoreLimit"
        min="1"
        class="form-control"
        placeholder="Enter score limit"
      />
    </div>
    <div class="player-info">
      <div class="player-name">
        <h4>Player 1</h4>
        <input
          type="text"
          [(ngModel)]="player1Name"
          class="form-control"
          placeholder="Enter Player 1 Name"
          disabled="true"
        />
      </div>
      <div class="player-name">
        <h4>Player 2</h4>
        <input
          type="text"
          [(ngModel)]="player2Name"
          class="form-control"
          placeholder="Enter Player 2 Name"
        />
      </div>
    </div>
    <div class="actions">
      <button class="start-game-btn" (click)="startNewGame()">
        <svg viewBox="0 0 24 24">
          <!-- Play Icon -->
          <path fill="#fff" d="M8 5v14l11-7z" />
        </svg>
        Start Game
      </button>
    </div>
  </section>

  <!-- Game Progress and Controls -->
  <section class="game-view" *ngIf="gameInProgress && currentGame">
    <p class="score">
      {{ getCurrentRound().round_number }} of {{ settings.maxRounds }} Rounds
      <strong>{{ player1Name }}:</strong> {{ currentGame.score_player1 }} -
      <strong>{{ player2Name }}:</strong> {{ currentGame.score_player2 }}
    </p>
    <app-game-canvas-pvp
      [gameSettings]="settings"
      (onScore)="updateScore($event)"
    ></app-game-canvas-pvp>
    <div class="timers">
      <p><strong>Game Timer:</strong> {{ gameElapsedTime }}</p>
      <p><strong>Round Timer:</strong> {{ roundElapsedTime }}</p>
    </div>
  </section>

  <!-- Game Results -->
  <section
    class="game-result"
    *ngIf="!gameInProgress && currentGame && currentGame.is_completed"
  >
    <div class="result-header">
      <h3>Game Over</h3>
    </div>
    <div class="result-body">
      <p><strong>Winner:</strong> {{ currentGame.winner?.username || 'Tie' }}</p>
      <p>
        <strong>Game Duration:</strong>
        {{ currentGame.duration | number: '1.2-2' }} seconds
      </p>

      <h4>Rounds Summary</h4>
      <ul class="summary-list">
        <li *ngFor="let round of currentGame.rounds" class="summary-item">
          <p>
            Round {{ round.round_number }} - Winner:
            {{ round.winner || 'In Progress' }} - Duration:
            {{ calculateRoundDuration(round) }}
          </p>
        </li>
      </ul>

      <h4>Moves Log</h4>
      <ul class="moves-log">
        <li *ngFor="let move of currentGame.moves_log" class="move-item">
          <span class="move-time">{{ move.time | date: 'shortTime' }}</span> -
          {{ move.player }}: {{ move.action }}
        </li>
      </ul>

      <button class="play-again-btn" (click)="startNewGame()">Play Again</button>
    </div>
  </section>

  <!-- Game Logs -->
  <!-- <section class="logs" *ngIf="logs.length || previousGames.length">
    <div class="logs-header">
      <h4>Logs</h4>
    </div>
    <ul class="log-list">
      <li *ngFor="let log of logs" class="log-item">{{ log }}</li>
    </ul>
    <h4>Previous Games</h4>
    <ul class="previous-games">
      <li *ngFor="let prevLog of previousGames" class="prev-game-item">{{
        prevLog
      }}</li>
    </ul>
  </section> -->
</div>
